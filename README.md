# 文华财经主力合约图表自动化截图与文档生成工具

## 项目简介

该工具可以自动打开文华财经软件，遍历所有主力合约，对每个合约的小时线、日线和周线图表进行截图，并将这些截图整合到一个Word文档中，大大减少了手工操作的工作量。

## 功能特点

- 自动打开文华财经软件
- 自动遍历所有主力合约
- 自动切换图表周期（小时线、日线、周线）
- 自动截取图表区域
- 自动生成包含所有截图的Word文档
- 可配置的截图区域和快捷键
- 可自定义合约列表

## 安装依赖

在使用本工具前，请确保已安装以下Python库：

```bash
pip install pyautogui python-docx pillow
```

## 配置说明

### 1. 配置文件 (config.ini)

配置文件包含以下几个部分：

- **paths**: 文华财经软件路径和输出目录
- **screenshot**: 截图区域的坐标和大小
- **hotkeys**: 文华财经软件的快捷键

```ini
[paths]
wenhua_executable = C:\Program Files\文华财经\文华财经V6\qhjy.exe
output_directory = output

[screenshot]
x = 200
y = 200
width = 800
height = 600

[hotkeys]
contract_list = F2
hour_chart = F5
daily_chart = F6
weekly_chart = F7
```

请根据您的实际情况修改以下配置：

1. `wenhua_executable`: 文华财经软件的可执行文件路径
2. `output_directory`: 输出目录，用于保存截图和生成的文档
3. `x`, `y`, `width`, `height`: 截图区域的坐标和大小，需要根据您的屏幕分辨率和文华财经窗口位置进行调整
4. 各种快捷键：根据您的文华财经软件实际快捷键进行调整

### 2. 合约列表 (contracts.json)

合约列表文件包含需要截图的所有期货合约信息，格式如下：

```json
[
    {"code": "RB", "name": "螺纹钢"},
    {"code": "HC", "name": "热轧卷板"},
    ...
]
```

每个合约包含两个字段：
- `code`: 合约代码，用于在文华财经中查找合约
- `name`: 合约名称，用于在生成的文档中显示

您可以根据需要添加、删除或修改合约列表。

## 使用方法

1. 确保已安装所有依赖库
2. 根据实际情况修改配置文件 (config.ini)
3. 根据需要修改合约列表 (contracts.json)
4. 运行脚本：

```bash
python wenhua_auto.py
```

## 注意事项

1. **截图区域设置**：在首次使用前，请确保正确设置截图区域。您可以使用屏幕坐标工具（如Windows自带的截图工具）来获取正确的坐标。

2. **文华财经窗口位置**：运行脚本前，请确保没有其他窗口遮挡文华财经窗口，并且窗口位置与配置的截图区域一致。

3. **异常处理**：脚本包含基本的异常处理机制，但在某些情况下（如文华财经软件未响应或窗口位置变化）可能会导致任务失败。如果遇到问题，请检查日志文件 (wenhua_auto.log) 以获取详细信息。

4. **权限问题**：确保脚本有足够的权限操作文华财经软件和保存文件。

## 定时任务设置（可选）

如果您希望定时运行自动化流程，可以使用Windows任务计划程序：

1. 打开任务计划程序
2. 创建基本任务
3. 设置触发器（如每天9点运行）
4. 设置操作为启动程序，程序路径为Python解释器，参数为脚本路径

## 输出结果

脚本运行完成后，将在配置的输出目录中生成以下内容：

1. `screenshots` 文件夹：包含所有合约图表的截图
2. Word文档：包含所有截图，文件名格式为 `主力合约图表截图_YYYYMMDD_HHMMSS.docx`
3. 日志文件：`wenhua_auto.log`，记录脚本运行的详细信息

## 故障排除

如果脚本运行过程中遇到问题，请尝试以下步骤：

1. 检查日志文件 (wenhua_auto.log) 以获取详细的错误信息
2. 确认文华财经软件路径是否正确
3. 调整截图区域坐标和大小
4. 确认快捷键设置是否与文华财经软件一致
5. 确保文华财经窗口没有被其他窗口遮挡

## 联系与支持

如有任何问题或建议，请联系开发者。